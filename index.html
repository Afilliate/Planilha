<html>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
    import { getFirestore, doc, setDoc, onSnapshot, runTransaction } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
    
    // Configurações e variáveis globais do Canvas (MANDATÓRIO)
    const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
    const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
    const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

    let app, db, auth;
    let userId = 'loading';
    let isAuthReady = false;
    let historyRecords = []; // Array para armazenar o histórico semanal
    let currentRoutine = {}; // Variável para armazenar a rotina da semana atual

    // Estruturas de dados (Conteúdo do V19.0 - Refatorado por Blocos de Foco)
    const initialRoutineBlueprint = {
        'Segunda': [
            // FOCO PRINCIPAL DO DIA: CRIAÇÃO DE COPY E ROTEIROS (TEXTO)
            { time: '15:00 - 16:00', task: '**CRIAÇÃO DE COPY P1 (60m):** Escrever 3 Ganchos Persuasivos de 10s (Foco em Objeção/Curiosidade)', product: 'P1', completed: false, account: 'Cash Flow' },
            { time: '16:00 - 17:00', task: '**ROTEIRO P3 (60m):** Criar 1 Roteiro Completo para Storytelling de Prova Social/Autoridade', product: 'P3', completed: false, account: 'Liberdade' },
            { time: '17:00 - 18:00', task: '**COPY P3 (60m):** Escrita de 2 Ganchos de Venda Rápida (para usar em Stories ou Carrosséis)', product: 'P3', completed: false, account: 'Liberdade' }
        ],
        'Terca': [
            // FOCO PRINCIPAL DO DIA: CRIAÇÃO DE ATIVOS (PRODUÇÃO E EDIÇÃO)
            { time: '15:00 - 16:00', task: '**PRODUÇÃO P1 (60m):** Gravação e Edição Final em Lote de 3 Vídeos Curvos (Usa Copy de Segunda)', product: 'P1', completed: false, account: 'Cash Flow' },
            { time: '16:00 - 17:00', task: '**PRODUÇÃO P3 (60m):** Design do Carrossel (P2) e Gravação/Edição do Vídeo Reação (Usa Roteiro de Segunda)', product: 'P3', completed: false, account: 'Liberdade' },
            { time: '17:00 - 18:00', task: '**ESTOQUE GERAL (60m):** Finalizar 1 Ativo Rápido (Vídeo de 30s ou Post de Dica) para o Estoque de Segurança', product: 'Geral', completed: false, account: 'Ambas' }
        ],
        'Quarta': [
            // FOCO PRINCIPAL DO DIA: OTIMIZAÇÃO & AGENDAMENTO (TAREFA CHAVE P/ PROGRESSO)
            { time: '15:00 - 16:00', task: '**AGENDAMENTO P1 (60m):** Otimização (Títulos/Tags/SEO) e Programação de 3 Posts VPN (Tarefa CHAVE)', product: 'P1', completed: false, account: 'Cash Flow' }, 
            { time: '16:00 - 17:00', task: '**AGENDAMENTO P3 (60m):** Revisão Final, Otimização e Programação de 3 Posts Assessoria (Tarefa CHAVE)', product: 'P3', completed: false, account: 'Liberdade' }, 
            { time: '17:00 - 18:00', task: '**ESTOQUE ROTEIROS (60m):** Criar 3 Novos Roteiros/Ganchos para a próxima semana', product: 'Geral', completed: false, account: 'Ambas' }
        ],
        'Quinta': [
            // FOCO PRINCIPAL DO DIA: ANÁLISE E AÇÃO CORRETIVA RÁPIDA
            { time: '15:00 - 16:30', task: '**ANÁLISE DE DADOS (90m):** Coleta de Dados P1 e P3 (Cliques, Engajamento, CTR) e Diagnóstico de Falhas', product: 'Geral', completed: false, account: 'Ambas' },
            { time: '16:30 - 17:15', task: '**AÇÃO CORRETIVA P3 (45m):** Criar V2 de Copy/Gancho para Teste Imediato (Baseado na Análise)', product: 'P3', completed: false, account: 'Liberdade' },
            { time: '17:15 - 18:00', task: '**ENGAGEMENT P3 (45m):** Interação (15 Perfis de Nicho) + Criação de 1 Story Estratégico (Venda Quente)', product: 'P3', completed: false, account: 'Liberdade' }
        ],
        'Sexta': [
            // FOCO PRINCIPAL DO DIA: PLANEJAMENTO ESTRATÉGICO E LIBERDADE
            { time: '15:00 - 16:00', task: '**PLANEJAMENTO FINANCEIRO (60m):** Reinvestimento (70% Lucro) e Criação de Fundo de Teste', product: 'P1', completed: false, account: 'Cash Flow' },
            { time: '16:00 - 17:00', task: '**MODELAGEM DE INVESTIMENTO (60m):** Análise de Milhas/Bancos (30% Lucro - Renda Passiva)', product: 'Geral', completed: false, account: 'Liberdade' },
            { time: '17:00 - 18:00', task: '**PREPARAÇÃO SEMANAL (60m):** Revisão de Checklist e Definição da Estrutura de Ganchos para a Próxima Semana', product: 'Geral', completed: false, account: 'Ambas' }
        ]
    };

    // Inicialização do Firebase e Autenticação
    const initializeFirebase = async () => {
        try {
            app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            auth = getAuth(app);
            
            if (initialAuthToken) {
                await signInWithCustomToken(auth, initialAuthToken);
            } else {
                await signInAnonymously(auth);
            }

            onAuthStateChanged(auth, async (user) => {
                if (user) {
                    userId = user.uid;
                } else {
                    userId = crypto.randomUUID(); // Fallback para anônimo
                }
                isAuthReady = true;
                console.log(`Firebase Ready. User ID: ${userId}`);
                loadData();
            });

        } catch (error) {
            console.error("Firebase initialization failed:", error);
            userId = crypto.randomUUID();
            isAuthReady = true;
            loadData(); 
        }
    };

    // Funções de manipulação do Firestore
    const getRoutineDocRef = () => doc(db, `/artifacts/${appId}/users/${userId}/daily_routine`, 'weeklyPlan');
    const getHistoryDocRef = () => doc(db, `/artifacts/${appId}/users/${userId}/daily_routine`, 'history_data');

    const loadData = () => {
        if (!isAuthReady) return;
        
        // Listener para a rotina da semana atual
        onSnapshot(getRoutineDocRef(), (docSnapshot) => {
            if (docSnapshot.exists()) {
                currentRoutine = docSnapshot.data().routine;
            } else {
                currentRoutine = JSON.parse(JSON.stringify(initialRoutineBlueprint));
                saveRoutine(currentRoutine);
            }
            renderRoutine();
        }, (error) => {
            console.error("Erro ao carregar rotina:", error);
            currentRoutine = JSON.parse(JSON.stringify(initialRoutineBlueprint));
            renderRoutine();
        });

        // Listener para o histórico
        onSnapshot(getHistoryDocRef(), (docSnapshot) => {
            if (docSnapshot.exists() && docSnapshot.data().history) {
                historyRecords = docSnapshot.data().history;
            } else {
                historyRecords = [];
            }
            renderRoutine();
        }, (error) => {
            console.error("Erro ao carregar histórico:", error);
        });
    };

    const saveRoutine = async (routineData) => {
        if (!isAuthReady) return;
        try {
            await setDoc(getRoutineDocRef(), { routine: routineData }, { merge: true });
        } catch (error) {
            console.error("Erro ao salvar rotina:", error);
        }
    };

    const toggleTask = (day, index) => {
        if (!isAuthReady) return;

        const newRoutine = JSON.parse(JSON.stringify(currentRoutine));
        const task = newRoutine[day][index];
        if (task) {
            task.completed = !task.completed;
            saveRoutine(newRoutine);
        }
    };

    const calculateScore = (routine) => {
        let completedCount = 0;
        let totalCount = 0;
        
        const days = ['Segunda', 'Terca', 'Quarta', 'Quinta', 'Sexta'];
        days.forEach(day => {
            if (routine[day]) {
                routine[day].forEach(task => {
                    totalCount++;
                    if (task.completed) {
                        completedCount++;
                    }
                });
            }
        });
        
        const percentage = totalCount > 0 ? Math.round((completedCount / totalCount) * 100) : 0;
        return { completedCount, totalCount, percentage };
    };

    const saveHistoryAndResetWeek = async () => {
        if (!isAuthReady || !currentRoutine) return;
        
        // 1. Calcular a pontuação da semana
        const { completedCount, totalCount, percentage } = calculateScore(currentRoutine);

        // Se nenhuma tarefa foi marcada, avisa antes de resetar
        if (completedCount === 0 && totalCount > 0) {
            // Em vez de alert(), usaremos console.error e uma mensagem na UI
            console.error("Nenhuma tarefa concluída. Semana não salva.");
            document.getElementById('save-message').innerText = 'Nenhuma tarefa concluída para salvar. Reiniciando...';
            setTimeout(() => document.getElementById('save-message').innerText = '', 3000);
        }

        // 2. Criar o novo registro
        const newRecord = {
            id: Date.now(),
            date: new Date().toLocaleDateString('pt-BR'),
            percentage: percentage,
            completed: completedCount,
            total: totalCount,
            message: `Consistência de ${percentage}% (Base: ${completedCount} de 15 tarefas)`
        };

        // 3. Salvar o histórico e resetar a rotina em uma transação para garantir a atomicidade
        try {
            await runTransaction(db, async (transaction) => {
                const historyRef = getHistoryDocRef();
                const routineRef = getRoutineDocRef();

                // a) Atualizar Histórico (apenas se houver tarefas concluídas)
                if (completedCount > 0) {
                    const historyDoc = await transaction.get(historyRef);
                    let currentHistory = historyDoc.exists() ? historyDoc.data().history : [];
                    currentHistory.unshift(newRecord); // Adicionar o novo registro no início
                    transaction.set(historyRef, { history: currentHistory }, { merge: true });
                }

                // b) Resetar Rotina
                const resetRoutineData = JSON.parse(JSON.stringify(initialRoutineBlueprint));
                transaction.set(routineRef, { routine: resetRoutineData });
            });
            
            document.getElementById('save-message').className = 'text-green-400 font-bold';
            document.getElementById('save-message').innerText = `Semana Finalizada! ${percentage}% de disciplina registrada. Rotina Resetada.`;
            setTimeout(() => document.getElementById('save-message').innerText = '', 4000);

        } catch (error) {
            console.error("Erro na transação de salvar/resetar:", error);
            document.getElementById('save-message').className = 'text-red-400 font-bold';
            document.getElementById('save-message').innerText = 'ERRO ao finalizar a semana. Tente novamente.';
            setTimeout(() => document.getElementById('save-message').innerText = '', 4000);
        }
    };
    
    // --- Componentes de Layout e Seções ---

    const renderHeader = () => {
        const { completedCount, totalCount, percentage } = calculateScore(currentRoutine);
        
        return `
            <div class="p-6 bg-gray-900 text-white rounded-t-xl shadow-lg">
                <h1 class="text-3xl font-extrabold text-indigo-400 mb-1">PLANO DE FOCO - V20.0 (Com Histórico)</h1>
                <p class="text-lg font-medium text-gray-300">Liberdade Financeira até os 20 Anos</p>
                <div class="mt-4 p-3 bg-indigo-900/50 rounded-lg text-sm">
                    <p class="font-bold text-indigo-300">Progresso da Semana Atual:</p>
                    <p class="text-gray-200 font-bold mt-1 text-xl">${percentage}% de Disciplina (${completedCount}/${totalCount} Tarefas)</p>
                    <p class="text-gray-200 font-bold mt-2">Horário Fixo: <span class="text-yellow-400">15:00h às 18:00h</span> (3 horas de Deep Work)</p>
                </div>
            </div>
        `;
    };

    const renderCreationGoals = (p1Count, p3Count) => {
        const creationGoals = [
            { label: 'Post 1: VPN (Cash Flow)', product: 'P1', index: 0 },
            { label: 'Post 2: VPN (Cash Flow)', product: 'P1', index: 1 },
            { label: 'Post 3: VPN (Cash Flow)', product: 'P1', index: 2 },
            { label: 'Post 4: Assessoria (Liberdade)', product: 'P3', index: 3 },
            { label: 'Post 5: Assessoria (Liberdade)', product: 'P3', index: 4 },
            { label: 'Post 6: Assessoria (Liberdade)', product: 'P3', index: 5 },
        ];
        
        // LÓGICA DE CÁLCULO DE METAS (IMPLEMENTADA)
        const calculateCreationGoals = (routine) => {
            let p1CompletedCount = 0;
            let p3CompletedCount = 0;

            const days = ['Quarta']; // Só checa Quarta, pois é o dia CHAVE do Agendamento
            days.forEach(day => {
                if (routine[day]) {
                    const p1Task = routine[day].find(t => t.task.includes('AGENDAMENTO P1'));
                    if (p1Task && p1Task.completed) p1CompletedCount = 3; 

                    const p3Task = routine[day].find(t => t.task.includes('AGENDAMENTO P3'));
                    if (p3Task && p3Task.completed) p3CompletedCount = 3; 
                }
            });

            return { p1CompletedCount, p3CompletedCount };
        };

        const { p1CompletedCount: currentP1Count, p3CompletedCount: currentP3Count } = calculateCreationGoals(currentRoutine);


        const goalItems = creationGoals.map((goal) => {
            const isP1 = goal.product === 'P1';
            const count = isP1 ? currentP1Count : currentP3Count;
            const isCompleted = goal.index < count;

            const productClass = isP1 ? 'text-indigo-300' : 'text-yellow-300';
            const checkColor = isP1 ? 'border-indigo-500' : 'border-yellow-500';
            const checkBg = isCompleted ? (isP1 ? 'bg-indigo-600' : 'bg-yellow-600') : 'bg-gray-600';
            
            return `
                <div class="flex items-center space-x-2 w-full sm:w-1/2 lg:w-1/3 p-2">
                    <div class="h-4 w-4 rounded-full flex items-center justify-center border-2 ${checkColor} ${checkBg} transition duration-300">
                        ${isCompleted ? 
                            `<svg class="w-3 h-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg>` : 
                            ''
                        }
                    </div>
                    <span class="text-sm font-medium ${productClass} ${isCompleted ? 'line-through opacity-75' : ''}">${goal.label}</span>
                </div>
            `;
        }).join('');

        return `
            <div class="bg-gray-900 p-6 rounded-xl shadow-xl mt-6">
                <h2 class="text-xl font-bold text-pink-400 mb-4 flex items-center">
                    <span class="text-2xl mr-2">🧞</span> Metas de Criação (Progresso Semanal)
                </h2>
                <p class="text-gray-400 mb-4 text-sm">Metas de volume: **3 posts (P1) + 3 posts (P3)**. Marcam automaticamente ao concluir a Quarta-feira (Agendamento).</p>
                <div class="flex flex-wrap -mx-2">
                    ${goalItems}
                </div>
            </div>
        `;
    };

    const renderHistory = () => {
        if (historyRecords.length === 0) {
            return `
                <div class="bg-gray-800 p-4 rounded-lg text-center text-gray-500 italic">
                    Nenhum histórico de disciplina encontrado. Finalize sua primeira semana!
                </div>
            `;
        }

        const historyItems = historyRecords.slice(0, 5).map(record => {
            const colorClass = record.percentage >= 80 ? 'text-green-400' : (record.percentage >= 60 ? 'text-yellow-400' : 'text-red-400');
            const icon = record.percentage >= 80 ? '⭐' : '📋';

            return `
                <div class="flex justify-between items-center p-3 bg-gray-800 rounded-lg border-l-4 border-gray-700 hover:bg-gray-700/50 transition duration-200">
                    <span class="text-sm text-gray-400 font-medium">${icon} Semana de ${record.date}</span>
                    <span class="text-xl font-extrabold ${colorClass}">${record.percentage}%</span>
                </div>
            `;
        }).join('');

        return `
            <div class="bg-gray-900 p-6 rounded-xl shadow-xl mt-6">
                <h2 class="text-xl font-bold text-yellow-400 mb-4 flex items-center">
                    <span class="text-2xl mr-2">📋</span> Histórico de Disciplina Semanal (Santo Agostinho)
                </h2>
                <p class="text-gray-400 mb-4 text-sm">Seu registro de consistência: ${historyRecords.length} semanas completas salvas.</p>
                <div class="space-y-3">
                    ${historyItems}
                </div>
                <div class="mt-4 p-2 bg-gray-800 rounded-lg text-center text-gray-500 italic text-xs">
                    Usuário ID: ${userId}
                </div>
            </div>
        `;
    };

    const renderWeekend = () => {
        const isSexta = new Date().getDay() === 5; // 5 é Sexta-feira
        const buttonClass = isSexta ? 'bg-red-600 hover:bg-red-700' : 'bg-gray-600 hover:bg-gray-700';

        return `
            <div class="bg-gray-900 p-6 rounded-xl shadow-xl mt-6">
                <h2 class="text-xl font-bold text-green-400 mb-4 flex items-center">
                    <span class="text-2xl mr-2">🔋</span> Fim de Semana e Lazer (Recarregar Energias)
                </h2>
                
                <div id="save-message" class="text-center mb-4 h-6 text-sm"></div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- SÁBADO -->
                    <div class="bg-gray-800 p-4 rounded-lg border border-gray-700">
                        <h3 class="text-lg font-extrabold text-white mb-2">SÁBADO</h3>
                        <p class="text-sm text-gray-400 mb-3">10:00 - 12:00 | Foco: Estratégia e Reinvestimento</p>
                        <ul class="space-y-2 text-sm text-gray-300">
                            <li class="flex items-center font-bold text-yellow-400">
                                <span class="mr-2 text-yellow-400">⭐</span> Após as 12:00: **LAZER GARANTIDO** (Você mereceu).
                            </li>
                        </ul>
                    </div>
                    <!-- DOMINGO -->
                    <div class="bg-gray-800 p-4 rounded-lg border border-gray-700">
                        <h3 class="text-lg font-extrabold text-white mb-2">DOMINGO</h3>
                        <p class="text-sm text-gray-400 mb-3">LIVRE | Foco: Descanso Total</p>
                        <ul class="space-y-2 text-sm text-gray-300">
                            <li class="flex items-center text-red-400 italic">
                                <span class="mr-2 text-red-400">❌</span> Nenhuma tarefa de marketing obrigatória!
                            </li>
                        </ul>
                    </div>
                </div>

                <button 
                    onclick="window.saveHistoryAndResetWeek()" 
                    class="w-full mt-6 py-3 px-4 rounded-xl font-extrabold text-white transition duration-300 transform hover:scale-[1.01] shadow-xl ${buttonClass}"
                    aria-label="Finalizar e Salvar Histórico Semanal"
                >
                    FINALIZAR SEMANA & REINICIAR TAREFAS
                </button>
            </div>
        `;
    };

    // Função principal de Renderização
    const renderRoutine = () => {
        const container = document.getElementById('routine-container');
        if (!container || !currentRoutine.Segunda) return; // Garante que a rotina foi carregada
        
        const daysOrder = ['Segunda', 'Terca', 'Quarta', 'Quinta', 'Sexta'];
        let html = '';

        // 1. Título e Meta
        html += renderHeader();

        // 2. Histórico (AGORA FUNCIONAL)
        html += renderHistory();
        
        // 3. Metas de Criação (RENDERIZADO DINAMICAMENTE)
        html += renderCreationGoals();
        
        // 4. Rotina Diária (Segunda a Sexta) - VISÃO EM BLOCOS VERTICAIS
        html += `<div class="p-4 sm:p-6 space-y-6 bg-gray-800 rounded-xl mt-6">`;
        
        daysOrder.forEach(day => {
            const tasks = currentRoutine[day] || [];
            
            // Determina a cor de destaque e ícone para o Novo Foco
            let headerClass = 'bg-gray-700 text-gray-100';
            let icon = '⚡️';
            if (day === 'Segunda') {
                headerClass = 'bg-indigo-600 text-white'; // COPY
                icon = '✍️';
            } else if (day === 'Terca') {
                headerClass = 'bg-pink-600 text-white'; // PRODUÇÃO
                icon = '🎬';
            } else if (day === 'Quarta') {
                headerClass = 'bg-green-600 text-white'; // OTIMIZAÇÃO & AGENDAMENTO
                icon = '✅';
            } else if (day === 'Quinta') {
                headerClass = 'bg-red-600 text-white'; // ANÁLISE & AÇÃO CORRETIVA
                icon = '📊';
            } else if (day === 'Sexta') {
                headerClass = 'bg-yellow-600 text-white'; // ESTRATÉGIA & FINANÇAS
                icon = '💸';
            }


            html += `
                <div class="flex flex-col bg-gray-900 rounded-lg shadow-2xl overflow-hidden">
                    <div class="${headerClass} p-4 text-left font-extrabold tracking-wider flex items-center justify-between">
                        <span class="text-2xl">${icon} ${day.toUpperCase()}</span>
                        <span class="text-sm font-normal text-white/80">15:00 - 18:00 (3h de Foco)</span>
                    </div>
                    <div class="p-4 sm:p-6 space-y-4 flex-grow">
            `;
            
            tasks.forEach((task, index) => {
                const isCompleted = task.completed;
                const statusClass = isCompleted ? 'bg-green-700 hover:bg-green-600' : 'bg-red-700 hover:bg-red-600';
                const textClass = isCompleted ? 'line-through text-gray-400' : 'text-gray-100';
                
                // Produto e Conta
                let accountTag = '';
                if (task.account === 'Cash Flow') {
                    accountTag = `<span class="bg-indigo-900 text-indigo-300 px-3 py-1 text-xs rounded-full font-bold">CASH FLOW (VPN)</span>`;
                } else if (task.account === 'Liberdade') {
                    accountTag = `<span class="bg-yellow-700 text-yellow-100 px-3 py-1 text-xs rounded-full font-bold">LIBERDADE (MILHAS)</span>`;
                } else {
                    accountTag = `<span class="bg-blue-600 text-blue-100 px-3 py-1 text-xs rounded-full font-bold">GERAL / GESTÃO</span>`;
                }

                html += `
                    <div class="flex items-start space-x-4 p-4 border border-gray-700 rounded-xl bg-gray-800 transition duration-300 hover:bg-gray-700/50">
                        <button 
                            onclick="toggleTask('${day}', ${index})" 
                            class="flex-shrink-0 w-8 h-8 rounded-full transition duration-150 ease-in-out flex items-center justify-center ${statusClass} border-2 border-white/20 shadow-md"
                            aria-label="Marcar como concluída"
                        >
                            ${isCompleted ? 
                                `<svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg>` : 
                                `<svg class="w-5 h-5 text-white/50" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M6 18L18 6M6 6l12 12"></path></svg>`
                            }
                        </button>
                        <div class="flex-grow min-w-0">
                            <div class="flex justify-between items-center mb-1">
                                <p class="text-sm font-semibold text-gray-400">${task.time}</p>
                                ${accountTag}
                            </div>
                            <p class="font-bold ${textClass} text-base">${task.task}</p>
                        </div>
                    </div>
                `;
            });

            html += `
                    </div>
                </div>
            `;
        });

        html += `</div>`; // Fechar o container da rotina
        
        // 5. Fim de Semana
        html += renderWeekend();

        container.innerHTML = html;
    };

    // Expondo as funções para o HTML
    window.toggleTask = toggleTask;
    window.saveHistoryAndResetWeek = saveHistoryAndResetWeek;

    // Inicialização
    document.addEventListener('DOMContentLoaded', initializeFirebase);
</script>

<style>
    body {
        font-family: 'Inter', sans-serif;
        background-color: #1f2937; /* Gray-800 */
    }
    /* Estilos para o scrollbar (opcional, mas melhora a estética) */
    ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
    }
    ::-webkit-scrollbar-thumb {
        background-color: #4b5563; /* Gray-600 */
        border-radius: 4px;
    }
    ::-webkit-scrollbar-track {
        background-color: #1f2937; /* Gray-800 */
    }
    /* Removendo a aparência padrão do checkbox e customizando para o botão */
    .form-checkbox {
        appearance: none;
        -webkit-appearance: none;
    }
</style>

<div id="routine-container" class="max-w-4xl mx-auto p-4 sm:p-6 lg:p-8">
    <!-- O conteúdo da rotina será renderizado aqui -->
</div>
<html>
    



    
